#######################################################################
# This file defines the outputs that are expected to be produced by the
# different PGEs within the PCM.
#
# Outputs - This area defines the different file name patterns for the
# expected outputs:
#
# Primary - Refers to the primary output product, which is usually the image (*.tif)
# files. Any product found here will be converted to a HySDS style
# dataset.
#
# Secondary - Refers to the other output product types like *.log, *.qa, etc.
# Any product found here will be copied into the dataset directories produced
# from the Primary section.
#
# Optional - Refers to other outputs that may/may not be produced from the
# PGE. If a product cannot be found with the regex patterns given here, PCM
# will still continue with processing.
#
# Missing_Metadata - Defines a list of metadata to fill in the .met.json.

# Key name MUST match the corresponding RunConfig jinja2 template filename.
L3_HLS:
  Outputs:
    Primary:
      # Pattern for parsing output image filenames, such as:
      # * "OPERA_L3_DSWx_HLS_L8_30_T22VEQ_20210905T143156Z_20220105T143156Z_v0.1_001_B01_WTF.tiff"
      # * "OPERA_L3_DSWx_HLS_S2A_30_T15SXR_20210907T163901Z_20220207T163901Z_v0.1_001_B09_CLOUD.tiff"
      - regex: !!python/regexp '(?P<id>(?P<project>OPERA)_(?P<level>L3)_(?P<product_type>DSWx_(?P<source>HLS))_(?P<sensor>S2A|S2B|L8)_(?P<spacing>30)_(?P<tile_id>T[^\W_]{5})_(?P<acquisition_ts>(?P<acq_year>\d{4})(?P<acq_month>\d{2})(?P<acq_day>\d{2})T(?P<acq_hour>\d{2})(?P<acq_minute>\d{2})(?P<acq_second>\d{2})Z)_(?P<creation_ts>(?P<cre_year>\d{4})(?P<cre_month>\d{2})(?P<cre_day>\d{2})T(?P<cre_hour>\d{2})(?P<cre_minute>\d{2})(?P<cre_second>\d{2})Z)_(?P<collection_version>v\d+[.]\d+)_(?P<product_counter>\d{3}))_(?P<band_index>B\d{2})_(?P<band_name>WTR|BWTR|CONF|DIAG|WTR-1|WTR-2|LAND|SHAD|CLOUD|DEM)[.](?P<ext>tiff)$'
        verify: true
        hash: md5
    Secondary:
      # Patterns for parsing aux filenames, such as:
      # * "OPERA_L3_DSWx_HLS_LANDSAT-8_T22VEQ_20210905T143156_v2.0_001.catalog.json"
      # * "OPERA_L3_DSWx_HLS_SENTINEL-2A_T15SXR_20210907T163901_v2.0_001.iso.xml"
      - regex: !!python/regexp '(?P<id>(?P<project>OPERA)_(?P<level>L3)_(?P<product_type>DSWx_(?P<source>HLS))_(?P<sensor>S2A|S2B|L8)_(?P<spacing>30)_(?P<tile_id>T[^\W_]{5})_(?P<acquisition_ts>(?P<acq_year>\d{4})(?P<acq_month>\d{2})(?P<acq_day>\d{2})T(?P<acq_hour>\d{2})(?P<acq_minute>\d{2})(?P<acq_second>\d{2})Z)_(?P<creation_ts>(?P<cre_year>\d{4})(?P<cre_month>\d{2})(?P<cre_day>\d{2})T(?P<cre_hour>\d{2})(?P<cre_minute>\d{2})(?P<cre_second>\d{2})Z)_(?P<collection_version>v\d+[.]\d+)_(?P<product_counter>\d{3}))[.](?P<ext>log|qa\.log|iso\.xml|catalog\.json)$'
        verify: false
    Optional: []
      # Pattern for optional output product filenames

  Missing_Metadata: {
  # "daac_product_type": "OPERA_L3_DSWX_HLS_0.0"
  }
